/* Coral library for low level data structure implementation
  Copyright (C) 1996-2019 AdaptiveFlow

  This library is dual-licensed: you can redistribute it and/or modify
 it under the terms of the GNU General Public License version 3 as 
 published by the Free Software Foundation. For the terms of this 
 license, see license/gpl-3.txt or <http://www.gnu.org/licenses/>.

  You are free to use this library under the terms of the GNU General
 Public License, but WITHOUT ANY WARRANTY; without even the implied 
 warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 See the GNU General Public License for more details.

  Alternatively, you can use this library under any other
 OSS licences ( like BSD ) or your own commercial license,
 as set out in LICENSE.txt. */

#ifndef __CORAL_TLS_H
#	define __CORAL_TLS_H

#include <coral/def.h>


__CBEGIN__

#define TLS_MAJOR_VERSION_DIFF 2
#define TLS_MINOR_VERSION_DIFF 1

#define TLS_RECORD_PAYLOAD_OFFSET 5

#define TLS_ALERT_RECORD      0x15
#define TLS_ALERT_CODE_OFFSET 6
#define TLS_ALERT_RECORD_SIZE 7
#define TLS_WARNING_ALERT     FAIL_RESERVED
#define TLS_FATAL_ALERT       (FAIL_RESERVED - 1)
#define TLS_VERSION_MISMATCH  (FAIL_RESERVED - 2)

#define TLS_HANDSHAKE_RECORD         0x16
#define TLS_HANDSHAKE_PAYLOAD_OFFSET 9
#define TLS_CLIENT_HELLO 1
#define TLS_SERVER_HELLO 2
#define TLS_CLIENT_KEY_EXCHANGE 0x10

#define TLS_CHANGE_CIPHER_SPEC 0x14
#define TLS_APPLICATION_DATA   0x17

#define TLS_HELLO_RANDOM_OFFSET 11
#define TLS_HELLO_FIXED_SIZE  44 /* offset to session id */
#define TLS_HELLO_SIZE(ext_offset, ext_size)\
	((ext_offset) + (ext_size))

#define TLS_KEY_MAX_LENGTH 32//512
#define TLS_HKDF_KEY_LENGTH 16
#define TLS_HKDF_IV_LENGTH 12
#define TLS_HMAC_SHA256_KEY_LENGTH 16
#define TLS_HMAC_SHA256_IV_LENGTH  16
#define TLS_KEY_TOTAL_LENGTH 64

struct _TLSHandshakeContext {
	CryptoSHA256Context sha256;
	unsigned version;
	unsigned keysize;
	unsigned flag;
	_unsigned8 key[FAM_DECL];
};
#define TLS_FLAG_ENCRYPT 0x0001

struct _TLSHello {
	unsigned session;
	unsigned cipher;
	unsigned compression;
	unsigned extension;
};

/* cipher suites */
#define TLS_NULL_WITH_NULL_NULL 0x0000
#define TLS_RSA_WITH_NULL_MD5 0x0001
#define TLS_RSA_WITH_NULL_SHA 0x0002
#define TLS_RSA_EXPORT_WITH_RC4_40_MD5 0x0003
#define TLS_RSA_WITH_RC4_128_MD5 0x0004
#define TLS_RSA_WITH_RC4_128_SHA 0x0005
#define TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5 0x0006
#define TLS_RSA_WITH_IDEA_CBC_SHA 0x0007
#define TLS_RSA_EXPORT_WITH_DES40_CBC_SHA 0x0008
#define TLS_RSA_WITH_DES_CBC_SHA 0x0009
#define TLS_RSA_WITH_3DES_EDE_CBC_SHA 0x000a
#define TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA 0x000b
#define TLS_DH_DSS_WITH_DES_CBC_SHA 0x000c
#define TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA 0x000d
#define TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA 0x000e
#define TLS_DH_RSA_WITH_DES_CBC_SHA 0x000f
#define TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA 0x0010
#define TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA 0x0011
#define TLS_DHE_DSS_WITH_DES_CBC_SHA 0x0012
#define TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA 0x0013
#define TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA 0x0014
#define TLS_DHE_RSA_WITH_DES_CBC_SHA 0x0015
#define TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA 0x0016
#define TLS_DH_anon_EXPORT_WITH_RC4_40_MD5 0x0017
#define TLS_DH_anon_WITH_RC4_128_MD5 0x0018
#define TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA 0x0019
#define TLS_DH_anon_WITH_DES_CBC_SHA 0x001a
#define TLS_DH_anon_WITH_3DES_EDE_CBC_SHA 0x001b
#define TLS_KRB5_WITH_DES_CBC_SHA 0x001e
#define TLS_KRB5_WITH_3DES_EDE_CBC_SHA 0x001f
#define TLS_KRB5_WITH_RC4_128_SHA 0x0020
#define TLS_KRB5_WITH_IDEA_CBC_SHA 0x0021
#define TLS_KRB5_WITH_DES_CBC_MD5 0x0022
#define TLS_KRB5_WITH_3DES_EDE_CBC_MD5 0x0023
#define TLS_KRB5_WITH_RC4_128_MD5 0x0024
#define TLS_KRB5_WITH_IDEA_CBC_MD5 0x0025
#define TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA 0x0026
#define TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA 0x0027
#define TLS_KRB5_EXPORT_WITH_RC4_40_SHA 0x0028
#define TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5 0x0029
#define TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5 0x002a
#define TLS_KRB5_EXPORT_WITH_RC4_40_MD5 0x002b
#define TLS_PSK_WITH_NULL_SHA 0x002c
#define TLS_DHE_PSK_WITH_NULL_SHA 0x002d
#define TLS_RSA_PSK_WITH_NULL_SHA 0x002e
#define TLS_RSA_WITH_AES_128_CBC_SHA 0x002f
#define TLS_DH_DSS_WITH_AES_128_CBC_SHA 0x0030
#define TLS_DH_RSA_WITH_AES_128_CBC_SHA 0x0031
#define TLS_DHE_DSS_WITH_AES_128_CBC_SHA 0x0032
#define TLS_DHE_RSA_WITH_AES_128_CBC_SHA 0x0033
#define TLS_DH_anon_WITH_AES_128_CBC_SHA 0x0034
#define TLS_RSA_WITH_AES_256_CBC_SHA 0x0035
#define TLS_DH_DSS_WITH_AES_256_CBC_SHA 0x0036
#define TLS_DH_RSA_WITH_AES_256_CBC_SHA 0x0037
#define TLS_DHE_DSS_WITH_AES_256_CBC_SHA 0x0038
#define TLS_DHE_RSA_WITH_AES_256_CBC_SHA 0x0039
#define TLS_DH_anon_WITH_AES_256_CBC_SHA 0x003a
#define TLS_RSA_WITH_NULL_SHA256 0x003b
#define TLS_RSA_WITH_AES_128_CBC_SHA256 0x003c
#define TLS_RSA_WITH_AES_256_CBC_SHA256 0x003d
#define TLS_DH_DSS_WITH_AES_128_CBC_SHA256 0x003e
#define TLS_DH_RSA_WITH_AES_128_CBC_SHA256 0x003f
#define TLS_DHE_DSS_WITH_AES_128_CBC_SHA256 0x0040
#define TLS_RSA_WITH_CAMELLIA_128_CBC_SHA 0x0041
#define TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA 0x0042
#define TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA 0x0043
#define TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA 0x0044
#define TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA 0x0045
#define TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA 0x0046
#define TLS_RSA_EXPORT1024_WITH_RC4_56_MD5 0x0060
#define TLS_RSA_EXPORT1024_WITH_RC2_CBC_56_MD5 0x0061
#define TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA 0x0062
#define TLS_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA 0x0063
#define TLS_RSA_EXPORT1024_WITH_RC4_56_SHA 0x0064
#define TLS_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA 0x0065
#define TLS_DHE_DSS_WITH_RC4_128_SHA 0x0066
#define TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 0x0067
#define TLS_DH_DSS_WITH_AES_256_CBC_SHA256 0x0068
#define TLS_DH_RSA_WITH_AES_256_CBC_SHA256 0x0069
#define TLS_DHE_DSS_WITH_AES_256_CBC_SHA256 0x006a
#define TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 0x006b
#define TLS_DH_anon_WITH_AES_128_CBC_SHA256 0x006c
#define TLS_DH_anon_WITH_AES_256_CBC_SHA256 0x006d
#define TLS_GOSTR341094_WITH_28147_CNT_IMIT 0x0080
#define TLS_GOSTR341001_WITH_28147_CNT_IMIT 0x0081
#define TLS_GOSTR341001_WITH_NULL_GOSTR3411 0x0082
#define TLS_GOSTR341094_WITH_NULL_GOSTR3411 0x0083
#define TLS_RSA_WITH_CAMELLIA_256_CBC_SHA 0x0084
#define TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA 0x0085
#define TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA 0x0086
#define TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA 0x0087
#define TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA 0x0088
#define TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA 0x0089
#define TLS_PSK_WITH_RC4_128_SHA 0x008a
#define TLS_PSK_WITH_3DES_EDE_CBC_SHA 0x008b
#define TLS_PSK_WITH_AES_128_CBC_SHA 0x008c
#define TLS_PSK_WITH_AES_256_CBC_SHA 0x008d
#define TLS_DHE_PSK_WITH_RC4_128_SHA 0x008e
#define TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA 0x008f
#define TLS_DHE_PSK_WITH_AES_128_CBC_SHA 0x0090
#define TLS_DHE_PSK_WITH_AES_256_CBC_SHA 0x0091
#define TLS_RSA_PSK_WITH_RC4_128_SHA 0x0092
#define TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA 0x0093
#define TLS_RSA_PSK_WITH_AES_128_CBC_SHA 0x0094
#define TLS_RSA_PSK_WITH_AES_256_CBC_SHA 0x0095
#define TLS_RSA_WITH_SEED_CBC_SHA 0x0096
#define TLS_DH_DSS_WITH_SEED_CBC_SHA 0x0097
#define TLS_DH_RSA_WITH_SEED_CBC_SHA 0x0098
#define TLS_DHE_DSS_WITH_SEED_CBC_SHA 0x0099
#define TLS_DHE_RSA_WITH_SEED_CBC_SHA 0x009a
#define TLS_DH_anon_WITH_SEED_CBC_SHA 0x009b
#define TLS_RSA_WITH_AES_128_GCM_SHA256 0x009c
#define TLS_RSA_WITH_AES_256_GCM_SHA384 0x009d
#define TLS_DHE_RSA_WITH_AES_128_GCM_SHA256 0x009e
#define TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 0x009f
#define TLS_DH_RSA_WITH_AES_128_GCM_SHA256 0x00a0
#define TLS_DH_RSA_WITH_AES_256_GCM_SHA384 0x00a1
#define TLS_DHE_DSS_WITH_AES_128_GCM_SHA256 0x00a2
#define TLS_DHE_DSS_WITH_AES_256_GCM_SHA384 0x00a3
#define TLS_DH_DSS_WITH_AES_128_GCM_SHA256 0x00a4
#define TLS_DH_DSS_WITH_AES_256_GCM_SHA384 0x00a5
#define TLS_DH_anon_WITH_AES_128_GCM_SHA256 0x00a6
#define TLS_DH_anon_WITH_AES_256_GCM_SHA384 0x00a7
#define TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256 0x00ba
#define TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256 0x00bb
#define TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256 0x00bc
#define TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256 0x00bd
#define TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 0x00be
#define TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256 0x00bf
#define TLS_EMPTY_RENEGOTIATION_INFO_SCSV 0x5600
#define TLS_AES_128_GCM_SHA256 0x1301
#define TLS_AES_256_GCM_SHA384 0x1302
#define TLS_CHACHA20_POLY1305_SHA256 0x1303
#define TLS_AES_128_CCM_SHA256 0x1304
#define TLS_AES_128_CCM_8_SHA256 0x1305
#define TLS_ECDH_ECDSA_WITH_NULL_SHA 0xc001
#define TLS_ECDH_ECDSA_WITH_RC4_128_SHA 0xc002
#define TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA 0xc003
#define TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA 0xc004
#define TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA 0xc005
#define TLS_ECDHE_ECDSA_WITH_NULL_SHA 0xc006
#define TLS_ECDHE_ECDSA_WITH_RC4_128_SHA 0xc007
#define TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA 0xc008
#define TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA 0xc009
#define TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA 0xc00a
#define TLS_ECDH_RSA_WITH_NULL_SHA 0xc00b
#define TLS_ECDH_RSA_WITH_RC4_128_SHA 0xc00c
#define TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA 0xc00d
#define TLS_ECDH_RSA_WITH_AES_128_CBC_SHA 0xc00e
#define TLS_ECDH_RSA_WITH_AES_256_CBC_SHA 0xc00f
#define TLS_ECDHE_RSA_WITH_NULL_SHA 0xc010
#define TLS_ECDHE_RSA_WITH_RC4_128_SHA 0xc011
#define TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA 0xc012
#define TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA 0xc013
#define TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA 0xc014
#define TLS_ECDH_anon_WITH_NULL_SHA 0xc015
#define TLS_ECDH_anon_WITH_RC4_128_SHA 0xc016
#define TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA 0xc017
#define TLS_ECDH_anon_WITH_AES_128_CBC_SHA 0xc018
#define TLS_ECDH_anon_WITH_AES_256_CBC_SHA 0xc019
#define TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA 0xc01a
#define TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA 0xc01b
#define TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA 0xc01c
#define TLS_SRP_SHA_WITH_AES_128_CBC_SHA 0xc01d
#define TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA 0xc01e
#define TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA 0xc01f
#define TLS_SRP_SHA_WITH_AES_256_CBC_SHA 0xc020
#define TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA 0xc021
#define TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA 0xc022
#define TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 0xc023
#define TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 0xc024
#define TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256 0xc025
#define TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384 0xc026
#define TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 0xc027
#define TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 0xc028
#define TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256 0xc029
#define TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384 0xc02a
#define TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 0xc02b
#define TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 0xc02c
#define TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256 0xc02d
#define TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384 0xc02e
#define TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 0xc02f
#define TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 0xc030
#define TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256 0xc031
#define TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384 0xc032
#define TLS_ECDHE_PSK_WITH_RC4_128_SHA 0xc033
#define TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA 0xc034
#define TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA 0xc035
#define TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA 0xc036
#define TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256 0xc037
#define TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384 0xc038
#define TLS_ECDHE_PSK_WITH_NULL_SHA 0xc039
#define TLS_ECDHE_PSK_WITH_NULL_SHA256 0xc03A
#define TLS_ECDHE_PSK_WITH_NULL_SHA384 0xc03B
#define TLS_RSA_WITH_ARIA_128_CBC_SHA256 0xc03C
#define TLS_RSA_WITH_ARIA_256_CBC_SHA384 0xc03D
#define TLS_DH_DSS_WITH_ARIA_128_CBC_SHA256 0xc03E
#define TLS_DH_DSS_WITH_ARIA_256_CBC_SHA384 0xc03F
#define TLS_DH_RSA_WITH_ARIA_128_CBC_SHA256 0xc040
#define TLS_DH_RSA_WITH_ARIA_256_CBC_SHA384 0xc041
#define TLS_DHE_DSS_WITH_ARIA_128_CBC_SHA256 0xc042
#define TLS_DHE_DSS_WITH_ARIA_256_CBC_SHA384 0xc043
#define TLS_DHE_RSA_WITH_ARIA_128_CBC_SHA256 0xc044
#define TLS_DHE_RSA_WITH_ARIA_256_CBC_SHA384 0xc045
#define TLS_DH_anon_WITH_ARIA_128_CBC_SHA256 0xc046
#define TLS_DH_anon_WITH_ARIA_256_CBC_SHA384 0xc047
#define TLS_ECDHE_ECDSA_WITH_ARIA_128_CBC_SHA256 0xc048
#define TLS_ECDHE_ECDSA_WITH_ARIA_256_CBC_SHA384 0xc049
#define TLS_ECDH_ECDSA_WITH_ARIA_128_CBC_SHA256 0xc04A
#define TLS_ECDH_ECDSA_WITH_ARIA_256_CBC_SHA384 0xc04B
#define TLS_ECDHE_RSA_WITH_ARIA_128_CBC_SHA256 0xc04C
#define TLS_ECDHE_RSA_WITH_ARIA_256_CBC_SHA384 0xc04D
#define TLS_ECDH_RSA_WITH_ARIA_128_CBC_SHA256 0xc04E
#define TLS_ECDH_RSA_WITH_ARIA_256_CBC_SHA384 0xc04F
#define TLS_RSA_WITH_ARIA_128_GCM_SHA256 0xc050
#define TLS_RSA_WITH_ARIA_256_GCM_SHA384 0xc051
#define TLS_DHE_RSA_WITH_ARIA_128_GCM_SHA256 0xc052
#define TLS_DHE_RSA_WITH_ARIA_256_GCM_SHA384 0xc053
#define TLS_DH_RSA_WITH_ARIA_128_GCM_SHA256 0xc054
#define TLS_DH_RSA_WITH_ARIA_256_GCM_SHA384 0xc055
#define TLS_DHE_DSS_WITH_ARIA_128_GCM_SHA256 0xc056
#define TLS_DHE_DSS_WITH_ARIA_256_GCM_SHA384 0xc057
#define TLS_DH_DSS_WITH_ARIA_128_GCM_SHA256 0xc058
#define TLS_DH_DSS_WITH_ARIA_256_GCM_SHA384 0xc059
#define TLS_DH_anon_WITH_ARIA_128_GCM_SHA256 0xc05A
#define TLS_DH_anon_WITH_ARIA_256_GCM_SHA384 0xc05B
#define TLS_ECDHE_ECDSA_WITH_ARIA_128_GCM_SHA256 0xc05C
#define TLS_ECDHE_ECDSA_WITH_ARIA_256_GCM_SHA384 0xc05D
#define TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256 0xc05E
#define TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384 0xc05F
#define TLS_ECDHE_RSA_WITH_ARIA_128_GCM_SHA256 0xc060
#define TLS_ECDHE_RSA_WITH_ARIA_256_GCM_SHA384 0xc061
#define TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256 0xc062
#define TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384 0xc063
#define TLS_PSK_WITH_ARIA_128_CBC_SHA256 0xc064
#define TLS_PSK_WITH_ARIA_256_CBC_SHA384 0xc065
#define TLS_DHE_PSK_WITH_ARIA_128_CBC_SHA256 0xc066
#define TLS_DHE_PSK_WITH_ARIA_256_CBC_SHA384 0xc067
#define TLS_RSA_PSK_WITH_ARIA_128_CBC_SHA256 0xc068
#define TLS_RSA_PSK_WITH_ARIA_256_CBC_SHA384 0xc069
#define TLS_PSK_WITH_ARIA_128_GCM_SHA256 0xc06A
#define TLS_PSK_WITH_ARIA_256_GCM_SHA384 0xc06B
#define TLS_DHE_PSK_WITH_ARIA_128_GCM_SHA256 0xc06C
#define TLS_DHE_PSK_WITH_ARIA_256_GCM_SHA384 0xc06D
#define TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256 0xc06E
#define TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384 0xc06F
#define TLS_ECDHE_PSK_WITH_ARIA_128_CBC_SHA256 0xc070
#define TLS_ECDHE_PSK_WITH_ARIA_256_CBC_SHA384 0xc071
#define TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 0xc072
#define TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 0xc073
#define TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 0xc074
#define TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 0xc075
#define TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 0xc076
#define TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384 0xc077
#define TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256 0xc078
#define TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384 0xc079
#define TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256 0xc07A
#define TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384 0xc07B
#define TLS_DHE_RSA_WITH_CAMELLIA_128_GCM_SHA256 0xc07C
#define TLS_DHE_RSA_WITH_CAMELLIA_256_GCM_SHA384 0xc07D
#define TLS_DH_RSA_WITH_CAMELLIA_128_GCM_SHA256 0xc07E
#define TLS_DH_RSA_WITH_CAMELLIA_256_GCM_SHA384 0xc07F
#define TLS_DHE_DSS_WITH_CAMELLIA_128_GCM_SHA256 0xc080
#define TLS_DHE_DSS_WITH_CAMELLIA_256_GCM_SHA384 0xc081
#define TLS_DH_DSS_WITH_CAMELLIA_128_GCM_SHA256 0xc082
#define TLS_DH_DSS_WITH_CAMELLIA_256_GCM_SHA384 0xc083
#define TLS_DH_anon_WITH_CAMELLIA_128_GCM_SHA256 0xc084
#define TLS_DH_anon_WITH_CAMELLIA_256_GCM_SHA384 0xc085
#define TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_GCM_SHA256 0xc086
#define TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_GCM_SHA384 0xc087
#define TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256 0xc088
#define TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384 0xc089
#define TLS_ECDHE_RSA_WITH_CAMELLIA_128_GCM_SHA256 0xc08A
#define TLS_ECDHE_RSA_WITH_CAMELLIA_256_GCM_SHA384 0xc08B
#define TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256 0xc08C
#define TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384 0xc08D
#define TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256 0xc08E
#define TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384 0xc08F
#define TLS_DHE_PSK_WITH_CAMELLIA_128_GCM_SHA256 0xc090
#define TLS_DHE_PSK_WITH_CAMELLIA_256_GCM_SHA384 0xc091
#define TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256 0xc092
#define TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384 0xc093
#define TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256 0xc094
#define TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384 0xc095
#define TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256 0xc096
#define TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384 0xc097
#define TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256 0xc098
#define TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384 0xc099
#define TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256 0xc09A
#define TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384 0xc09B
#define TLS_RSA_WITH_AES_128_CCM 0xc09c
#define TLS_RSA_WITH_AES_256_CCM 0xc09d
#define TLS_DHE_RSA_WITH_AES_128_CCM 0xc09e
#define TLS_DHE_RSA_WITH_AES_256_CCM 0xc09f
#define TLS_RSA_WITH_AES_128_CCM_8 0xc0a0
#define TLS_RSA_WITH_AES_256_CCM_8 0xc0a1
#define TLS_DHE_RSA_WITH_AES_128_CCM_8 0xc0a2
#define TLS_DHE_RSA_WITH_AES_256_CCM_8 0xc0a3
#define TLS_PSK_WITH_AES_128_CCM 0xc0a4
#define TLS_PSK_WITH_AES_256_CCM 0xc0a5
#define TLS_DHE_PSK_WITH_AES_128_CCM 0xc0a6
#define TLS_DHE_PSK_WITH_AES_256_CCM 0xc0a7
#define TLS_PSK_WITH_AES_128_CCM_8 0xc0a8
#define TLS_PSK_WITH_AES_256_CCM_8 0xc0a9
#define TLS_PSK_DHE_WITH_AES_128_CCM_8 0xc0aa
#define TLS_PSK_DHE_WITH_AES_256_CCM_8 0xc0ab
#define TLS_ECDHE_ECDSA_WITH_AES_128_CCM 0xc0ac
#define TLS_ECDHE_ECDSA_WITH_AES_256_CCM 0xc0ad
#define TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 0xc0ae
#define TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8 0xc0af
#define TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256_OLD 0xcc13
#define TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256_OLD 0xcc14
#define TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256_OLD 0xcc15
#define TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 0xcca8
#define TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 0xcca9
#define TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256 0xccaa
#define TLS_PSK_WITH_CHACHA20_POLY1305_SHA256 0xccab
#define TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256 0xccac
#define TLS_DHE_PSK_WITH_CHACHA20_POLY1305_SHA256 0xccad
#define TLS_RSA_PSK_WITH_CHACHA20_POLY1305_SHA256 0xccae
#define TLS_GOSTR341094_RSA_WITH_28147_CNT_MD5 0xff00
#define TLS_RSA_WITH_28147_CNT_GOST94 0xff01

#define TLS_EXTENSION_OFFSET      4
#define TLS_LIST_EXTENSION_OFFSET 6

#define TLS_CLIENT_PUBLIC_KEY_OFFSET \
	(TLS_HANDSHAKE_PAYLOAD_OFFSET + 1)
#define TLS_SERVER_CURVE_INFO_OFFSET \
	TLS_HANDSHAKE_PAYLOAD_OFFSET
#define TLS_SERVER_PUBLIC_KEY_OFFSET \
	(TLS_SERVER_CURVE_INFO_OFFSET + 4)

#define TLS_SERVER_CERT_SEQ_OFFSET \
	(TLS_HANDSHAKE_PAYLOAD_OFFSET + 6 + 8)

#define TLS_SERVER_NAME 0
/* extensions, supported groups */

#define TLS_SUPPORTED_GROUP 0x0a
#define TLS_SECP256R1 23
#define TLS_SECP384R1 24
#define TLS_SECP521R1 25
#define TLS_X25519    29
#define TLS_X448      30


/* extensions, algorithms */

#define TLS_SIGNATURE_ALGORITHM 0x0d
/* hash algorithms */
#define TLS_NONE      0
#define TLS_MD5       1
#define TLS_SHA1      2
#define TLS_SHA224    3
#define TLS_SHA256    4
#define TLS_SHA384    5
#define TLS_SHA512    6
#define TLS_SIGNATURE_SCHEME 8 /* tls 1.3 */

/* signature algorithms */
#define TLS_ANONYMOUS    0
#define TLS_RSA          1
#define TLS_DSA          2
#define TLS_ECDSA        3

/* tls 1.3 */
#define TLS_RSA_PSS_RSAE_SHA256 4
#define TLS_RSA_PSS_RSAE_SHA384 5
#define TLS_RSA_PSS_RSAE_SHA512 6
#define TLS_ED25519             7
#define TLS_ED448               8
#define TLS_RSA_PSS_PSS_SHA256  9
#define TLS_RSA_PSS_PSS_SHA384  0xa
#define TLS_RSA_PSS_PSS_SHA512  0xb

#define TLS_RENEGOTIATION_INFO 0xff01
#define TLS_SCT                0x0012

/* tls 1.3 */
#define TLS_KEY_SHARE         0x33
/* client can send multiple keys,
	so this is offset of the first item */
#	define TLS_CLIENT_KEY_EXCHANGE_OFFSET \
		TLS_LIST_EXTENSION_OFFSET
#	define TLS_CLIENT_KEY_LENGTH_OFFSET \
		(TLS_LIST_EXTENSION_OFFSET + 2)
#	define TLS_SERVER_KEY_EXCHANGE_OFFSET \
		TLS_EXTENSION_OFFSET
#	define TLS_SERVER_KEY_LENGTH_OFFSET \
		(TLS_LIST_EXTENSION_OFFSET + 2)
#define TLS_KEY_EXCHANGE_MODE 0x2d
#	define TLS_PSK     0
#	define TLS_PSK_DHE 1
#define TLS_SUPPORTED_VERSION 0x2b


__CEND__

#endif /* __CORAL_TLS_H */

